version: "3"
services:
  database:
    build: ./database
    environment:
      POSTGRES_PASSWORD: insecure
      POSTGRES_USER: panorama

  worker:
    build: ../web
    links:
      - database:database
    environment:
      DATABASE_PORT_5432_TCP_ADDR: database
      DATABASE_PORT_5432_TCP_PORT: 5432
      DATABASE_NAME: panorama
      DATABASE_USER: panorama
      DATABASE_PASSWORD: insecure
      OBJECTSTORE_PASSWORD:
    command: >
      bash -c "/app/scheduler-wait.sh \
                          && python manage.py work"

